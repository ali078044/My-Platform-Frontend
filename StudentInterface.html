<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>واجهة الطالب</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #007bff; --secondary: #FFCA28; --light: #f8f9fa; --dark: #343a40; --radius: 8px; --shadow: 0 4px 12px rgba(0,0,0,0.1); }
        body { font-family: 'Segoe UI', sans-serif; background: var(--light); color: var(--dark); margin: 0; }
        .hidden { display: none !important; }
        header { background: linear-gradient(90deg, #0056b3, #007bff); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        header h2 { margin: 0; }
        #logoutBtn { background: var(--secondary); color: var(--dark); border: none; padding: 10px 15px; border-radius: var(--radius); cursor: pointer; font-weight: bold; }
        .container { max-width: 1000px; margin: 20px auto; padding: 0 20px; }
        .card { background: white; padding: 25px; border-radius: var(--radius); box-shadow: var(--shadow); margin-bottom: 20px; }
        .profile { display: flex; align-items: center; gap: 20px; }
        .profile img { width: 60px; height: 60px; border-radius: 50%; }
        .controls { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        #lessonsList { list-style: none; padding: 0; }
        #lessonsList li { background: #f1f1f1; padding: 15px; border-radius: 4px; margin-bottom: 10px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background-color 0.2s; }
        #lessonsList li:hover { background-color: #e0e0e0; }
        .spinner { width: 30px; height: 30px; border: 3px solid rgba(0,0,0,0.1); border-left-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: auto; }
        @keyframes spin { to { transform: rotate(360deg); } }
        #lessonDetailView h3 { text-align: center; margin-bottom: 20px; }
        .lesson-part { margin-bottom: 20px; }
        .part-header { font-weight: bold; font-size: 1.2rem; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 2px solid var(--primary); }
        .content-box, iframe { width: 100%; box-sizing: border-box; }
        .content-box { line-height: 1.7; }
        iframe { height: 500px; border: 1px solid #ddd; border-radius: 4px; }
        .quiz-option { display: block; background: #f9f9f9; padding: 12px; margin-bottom: 8px; border-radius: 4px; cursor: pointer; border: 2px solid transparent; }
        .quiz-option.selected { border-color: var(--primary); background: #e7f1ff; }
        .quiz-nav { display: flex; justify-content: center; margin-top: 20px; }
        #quizResult { text-align: center; }
    </style>
</head>
<body>
    <header>
        <h2 id="studentName">أهلاً بك</h2>
        <button id="logoutBtn">تسجيل الخروج</button>
    </header>
    <div class="container">
        <div class="card profile">
            <img id="profilePic" alt="Profile Picture">
            <h3>منطقة الطالب</h3>
        </div>
        <!-- Lesson Selection View -->
        <div id="selectionView" class="card">
            <div class="controls">
                <select id="classSelect" onchange="loadSubjects(this.value)"><option>-- تحميل الصفوف... --</option></select>
                <select id="subjectSelect" onchange="loadChapters(this.value)" disabled><option>-- اختر المادة --</option></select>
                <select id="chapterSelect" onchange="loadLessons()" disabled><option>-- اختر الفصل --</option></select>
            </div>
            <ul id="lessonsList"><li class="empty-state">اختر من القوائم أعلاه لعرض الدروس</li></ul>
        </div>
        <!-- Lesson Detail View -->
        <div id="lessonDetailView" class="card hidden">
            <button onclick="showSelectionView()"> &larr; العودة للدروس</button>
            <h3 id="lessonTitle"></h3>
            <div id="lessonContent"></div>
            <!-- Quiz Section -->
            <div id="quizPart" class="hidden">
                <div class="part-header">اختبار الدرس</div>
                <div id="quizQuestion">
                    <p id="quizQuestionText"></p>
                    <div id="quizOptions"></div>
                </div>
                <div id="quizNav" class="quiz-nav">
                    <button id="quizNextBtn" onclick="handleQuizNav()">التالي</button>
                </div>
                <div id="quizResult" class="hidden">
                    <h4>النتيجة النهائية</h4>
                    <p id="quizScore" style="font-size: 2rem; font-weight: bold;"></p>
                    <button onclick="startQuiz()">إعادة الاختبار</button>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
